## 예제

아래 예제에서 상위 div에만 onclick 이벤트를 걸었지만, 하위 div를 클릭해도 onclick 이벤트가 실행된다.

```html
<div onclick="showMessage()">
  Click me!
  <div>I am child!</div>
</div>

<script>
  function showMessage() {
    alert("Clicked!");
  }
</script>
```

## 버블링

한 요소에 이벤트가 발생하면 이 요소에 할단된 핸들러가 동작하고 이어 부모 요소의 핸들러가 동작하며, 가장 최상단의 요소를 만날때까지 이 동작을 반복한다.

```html
<div onclick="alert('I am parent')">
  I am parent
  <div onclick="alert('I am child')">
    I am child
    <div onclick="alert('I am child of child')">I am child of child</div>
  </div>
</div>
```

위 예제에서 가장 하위 요소인 `I am child of child`를 클릭하면 다음과 같은 동작이 발생한다.

- I am child of child 요소의 핸들러 실행 `alert('I am child of child')
- I am child 요소의 핸들러 실행 `alert('I am child ')
- I am parent 요소의 핸들러 실행 `alert('I am parent ')

따라서 세개의 핸들러가 실행됨에 따라 세번의 alert이 노출된다.

### target, currentTarget

핸들러가 실행된 요소에 대한 정보를 target과 currentTarget으로 알 수 있다.

```html
<div>
  I am parent
  <div>
    I am child
    <div>I am child of child</div>
  </div>
</div>

<script>
  document.querySelectorAll("div").forEach((div) => {
    div.addEventListener("click", (e) => {
      console.log("target: ", e.target);
      console.log("currentTarget: ", e.currentTarget);
    });
  });
</script>
```

- target: 실제 핸들러가 동작된 타겟 요소
- currentTarget: 현재 실행중인 핸들러가 할당신 현재 요소

### 버블링 중단하기

`e.stopPropagation` 메서드로 버블링을 중단할 수 있다.

```html
<div class="parent">
  I am parent
  <div class="child">
    I am child
    <div class="child-of-child">I am child of child</div>
  </div>
</div>

<script>
  document.querySelectorAll("div").forEach((div) => {
    div.addEventListener("click", (e) => {
      console.dir(e.currentTarget.className);
    });
  });
</script>
```

위 예제에서는 `stopPropagation`에 의해 현재 요소에 등록된 핸들러만 실행한다.

## 캡처링

버블링과 반대로 상위 요소에서 하위 요소로 이벤트를 전파하는 캡처링이라는 흐름도 있다.

```html
<div class="parent">
  I am parent
  <div class="child">
    I am child
    <div class="child-of-child">I am child of child</div>
  </div>
</div>

<script>
  document.querySelectorAll("div").forEach((div) => {
    div.addEventListener("click", (e) => {
      console.dir("버블링: ", e.currentTarget.className);
    });

    div.addEventListener(
      "click",
      (e) => {
        console.dir("캡처링: ", e.currentTarget.className);
      },
      true
    );
  });
</script>
```

`addEventListener` 함수의 세번째 인자로 `true` 혹은 `{ capture: true }`를 할당하여 버블링이 아닌 캡처링을 적용할 수 있다. (기본값은 false)

### 핸들러 제거

`addEventListener`의 세번째 인자로 true를 설정하여 캡처링을 적용한 핸들러는 `removeEventListener`로 핸들러를 지울때도 동일하게 세번째 인자를 true로 줘야한다.

```javascript
div.addEventListener("click", () => {}, true);
div.removeEventListener("click", () => {}, true);
```
